***Prog1___Apartment.ned(module name)

package postalnettutorial;                           //package name of modules,

//
// TODO auto-generated module
//
simple Apartment                                     //This Apartment module belongs to the postalnettutorial package.A simple module can contain
                                                        parameters,gates & C++ implementation (Apartment.cc).
{
    parameters:                                      //This section lists configuration parameters for the module.

        @display("i=misc/house");                    // This sets the icon used for the module. In the graphical OMNeT++ simulation.i=misc/house means:
                                                            Use the “house” icon from the misc icon folder.
        int apartmentID = default(-1);               //Declares an integer parameter named apartmentID.default(-1) means:
                                                          If the user does not set this parameter in omnetpp.ini,
                                                            It will automatically take the value –1.You can assign a unique ID to each apartment.

    gates:                                           //Declares the communication ports of the module.

        inout gate;                                  //This creates a gate named gate.It can both send and receive messages.
                                                          Useful for exchanging messages between modules like Postman, Neighbors, Network nodes.
}

***prog2___PacketStation.ned(module name)

package postalnettutorial;//package name of modules,

//
// TODO auto-generated module
//
simple PacketStation                             //This PacketStation module belongs to the postalnettutorial package.A simple module can contain
                                                      parameters,gates & C++ implementation (Apartment.cc).
{
    parameters:
 		
 		@display("i=misc/post_vs");                  //i=misc/post_vs" means-Use the icon post_vs located in OMNeT++’s misc icon folder.
 		
 	gates:
 
 		inout gate[3];                               //Creates an array of 3 inout gates named gate.
 		inout out_gate;                              //A separate inout gate not part of the array.This gate can be used as the central output,
                                                      while gate[0..2] are used for connections to nearby nodes.
}

***prog3___Community.ned(module name)

package postalnettutorial;                       //Declares that this module belongs to the postalnettutorial package.

import postalnettutorial.Apartment;              //These lines import the two modules you will use inside Community
import postalnettutorial.PacketStation;

module Community                                  //Declares a compound module named Community.
                                                      A compound module contains:parameters,gates,submodules,connections
{
    parameters:
 		@display("i=misc/town_l");                     //Sets the icon to a town symbol.
 		int numApartment = 3;                         // not default, fixed//Declares a parameter that defines how many apartments your community has.

 		int commID = default(-1);                      //A unique ID for this community.If not set in omnetpp.ini, it becomes −1.
 		
 	gates: 
		inout comm_gate;                               //A communication gate for the whole community.Can send and receive messages.
                                                        Used to connect this community to something else (e.g., a central router, hub, or another community).
 
    submodules:
 		apartment[numApartment]: Apartment;            //Creates an array of Apartment modules, size 3.
 		post: PacketStation;                            //Creates a single PacketStation submodule.This will act as a hub/router for the apartments.
 		
 	connections:
         apartment[0].gate <--> post.gate[0];        //Connects each apartment to one gate on the PacketStation.
         apartment[1].gate <--> post.gate[1];
         apartment[2].gate <--> post.gate[2];
         post.out_gate <--> comm_gate;              //Connects the PacketStation’s outgoing gate to the community’s main gate.
                                                    This lets the community send/receive messages from outside.
}

***prog4___PostalNet.ned(module name)

package postalnettutorial.simulations;
 
import postalnettutorial.Community;
import postalnettutorial.Apartment;
import postalnettutorial.PacketStation;

network PostalNet 								 //Declares a network called PostalNet.Networks can include submodules (modules) and connections.
{
   parameters:
 		int numCommunities = 2; 					// not default, fixed.//Declares a network parameter numCommunities.
															This determines how many Community modules will exist in the network.Here it is fixed to 2.
 	submodules:
 		community[numCommunities]: Community;			//Creates an array of Community modules.The number of communities is controlled by numCommunities.
 
 	connections:
 		community[0].comm_gate <--> community[1].comm_gate;  //Connects the main gates of the two communities.
																	Effectively, the two communities can now exchange packets via their PacketStations.
}

***prog5___Apartment.cc(module name)

#include "Apartment.h"

Define_Module(Apartment);

void Apartment::initialize()
{
    // get parameters from parent modules
    int apartments = getParentModule()->par("numApartments");								//returns the Community module.
    int communities = getParentModule()->getParentModule()->par("numCommunities");		 //returns the top-level network.it declares how many apartments are in this community
																						how many communities exist in the whole network

    EV << "We have " << apartments << " apartments per community and "
       << communities << " communities.\n"; 											//Prints information to the eventlog/output for debugging.

    // select random destination
    int destComm = intuniform(0, communities - 1);										//intuniform(a, b) generates a random integer between a and b (inclusive).
    int destApartment = intuniform(0, apartments - 1);

    // create and send message
    cMessage *letter1 = new cMessage();													//Creates a new message named letter1.Adds two parameters inside the message- destCommunity destApartment
																						These parameters tell the message where it should go.
    letter1->addPar("destCommunity") = destComm;
    letter1->addPar("destApartment") = destApartment;

    sendDelayed(letter1, 50, "gate$o");									//Sends the message after 50 simulation seconds.Sends it through the output gate called gate.
}


void Apartment::handleMessage(cMessage *msg)
{
    // TODO - Generated method body
    // is this a self-timer? no currently used.
     if (msg->isSelfMessage()) 						//If the message is a self scheduled event, it ends the simulation.
														You are not using self messages in this task, so this is just safety code.
	 {
     EV << "Self-timers are currently not in use, stop simulation.\n";
     endSimulation();
     }
     if (((int)msg->par("destCommunity") == (int)getParentModule()->par("communityID")) //Message is for this community
    && ((int)msg-> par("destApartment") == (int)par("apartmentID"))) 					//Message is for this apartment
	{
     // letter received and checked that it was correctly sent. simply print out a debug message
     EV << "Letter received.\n";
     // delete the message
     delete msg;
     }
}

***prog6___PacketStation.cc(module name)

#include "PacketStation.h"

Define_Module(PacketStation);

void PacketStation::initialize()
{
    // TODO - Generated method body
}

void PacketStation::handleMessage(cMessage *msg)
{
    // TODO - Generated method body
    EV << "Message received.\n";
    // is this a self-timer? no currently used.
    if (msg->isSelfMessage()) 
	{
    EV << "Self-timers are currently not in use, stop simulation.\n";
    endSimulation();
    }
    // if a message is received for my village, forward it to the house.
    if ((int)msg->par("destCommunity") == (int)getParentModule()->par("communityID")) //PacketStation belongs to a community.
																						If the message is meant for THIS community → deliver to the correct apartment.
	{
    EV << "Same community, send directly to apartment.\n";
    // find out which house
    int house = msg->par("destApartment");								//destApartment tells which apartment to forward to. Uses gate$o[index] to select the correct gate.
																			Sends the message there.
    // get a pointer to the out gate
    cGate *where = gate("gate$o", house);//
    // send it out
    send(msg, where);
    }
    else 
	{
    EV << "Other community, send.\n";									//Message belongs to another community.Forward it outward through out_gate$o.
    send(msg, "out_gate$o");
    }
}

***prog7___omnetpp.ini

[General]
network = PostalNet 					//“The top-level network that should be simulated is the PostalNet NED network.”
record-eventlog = true					//You need this to generate sequence charts in the IDE.

# set community IDs
**.community[0].communityID = 0			//This assigns communityID = 0 to the first community
**.community[1].communityID = 1			//And communityID = 1 to the second one

# set apartment numbers
**.apartment[0].apartmentID = 0			//" ** " means Apply this to any module in the network that matches
**.apartment[1].apartmentID = 1
**.apartment[2].apartmentID = 2
